/*! Crocodoc Viewer - v0.10.10 | (c) 2015 Box */
!function(a){"use strict";a.Crocodoc=function(a){return"object"!=typeof exports?a(jQuery):void(module.exports=a)}(function(b){function c(){a.loadSVG=function(b){var c=new a.DOMParser,d=c.parseFromString(b,"image/svg+xml"),e=document.importNode(d.documentElement,!0);e.setAttribute("width","100%"),e.setAttribute("height","100%"),document.body?document.body.appendChild(e):document.documentElement.appendChild(e)}}var d="crocodoc-",e="data-svg-version",f=d+"viewer",g=d+"doc",h=d+"viewport",i=d+"viewer-logo",j=d+"draggable",k=d+"dragging",l=d+"text-selected",m=d+"text-disabled",n=d+"links-disabled",o=d+"mobile",p=d+"ielt9",q=d+"supports-svg",r=d+"window-as-viewport",s=d+"layout-",t=d+"current-page",u=d+"preceding-page",v=d+"page",w=v+"-inner",x=v+"-content",y=v+"-svg",z=v+"-text",A=v+"-link",B=v+"-links",C=v+"-autoscale",D=v+"-loading",E=v+"-error",F=v+"-visible",C=v+"-autoscale",G=v+"-prev",H=v+"-next",I=v+"-before",J=v+"-after",K=v+"-before-buffer",L=v+"-after-buffer",M=[H,J,G,I,K,L].join(" "),N='<div tabindex="-1" class="'+h+'"><div class="'+g+'"></div></div><div class="'+i+'"></div>',O='<div class="'+v+" "+D+'" style="width:{{w}}px; height:{{h}}px;" data-width="{{w}}" data-height="{{h}}"><div class="'+w+'"><div class="'+x+'"><div class="'+y+'"></div><div class="'+C+'"><div class="'+z+'"></div><div class="'+B+'"></div></div></div></div></div>',P=1024,Q="fitwidth",R="fitheight",S="auto",T="in",U="out",V="previous",W="next",X="vertical",Y="vertical-single-column",Z="horizontal",$="presentation",_="presentation-two-page",aa="text",ba="converting",ca="not loaded",da="loading",ea="loaded",fa="error",ga="padding-",ha=ga+"top",ia=ga+"right",ja=ga+"left",ka=ga+"bottom",la=.95,ma=.99,na=100,oa=32,pa=8,qa=1e3,ra="image/svg+xml",sa="<style>html,body{width:100%;height:100%;margin:0;overflow:hidden;}</style>",ta='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"><script><![CDATA[('+c+")()]]></script></svg>",ua=1,va=2,wa=3,xa=4,ya=5,za=6,Aa=7,Ba=8;if("undefined"==typeof b)throw new Error("jQuery is required");var Ca=function(){function a(c,d,e){var f;for(e=e||c,f=0;f<d.length;++f){if(c===d[f])throw new Error("Circular dependency detected: "+e+"->"+d[f]);b[d[f]]&&a(c,b[d[f]].mixins,e+"->"+d[f])}}var b={},c={};return{ZOOM_FIT_WIDTH:Q,ZOOM_FIT_HEIGHT:R,ZOOM_AUTO:S,ZOOM_IN:T,ZOOM_OUT:U,SCROLL_PREVIOUS:V,SCROLL_NEXT:W,LAYOUT_VERTICAL:X,LAYOUT_VERTICAL_SINGLE_COLUMN:Y,LAYOUT_HORIZONTAL:Z,LAYOUT_PRESENTATION:$,LAYOUT_PRESENTATION_TWO_PAGE:_,LAYOUT_TEXT:aa,ASSET_REQUEST_RETRIES:1,viewerTemplate:N,pageTemplate:O,components:b,utilities:c,createViewer:function(a,b){return new Ca.Viewer(a,b)},getViewer:function(a){return Ca.Viewer.get(a)},addComponent:function(c,d,e){d instanceof Function&&(e=d,d=[]),a(c,d),b[c]={mixins:d,creator:e}},createComponent:function(a,c){var d=b[a];if(d){for(var e=[],f=0;f<d.mixins.length;++f)e.push(this.createComponent(d.mixins[f],c));return e.unshift(c),d.creator.apply(d.creator,e)}return null},addPlugin:function(a,b){this.addComponent("plugin-"+a,b)},addDataProvider:function(a,b){this.addComponent("data-provider-"+a,b)},addUtility:function(a,b){c[a]={creator:b,instance:null}},getUtility:function(a){var b=c[a];return b?(b.instance||(b.instance=b.creator(this)),b.instance):null}}}();return function(){Ca.Scope=function(a){function c(a,b){var c,d,e,h;for(c=0,d=g.length;d>c;++c)e=g[c],e&&(h=e.messages||[],-1!==f.inArray(a,h)&&f.isFn(e.onmessage)&&e.onmessage.call(e,a,b))}function d(){for(var a;h.length;)a=h.shift(),c(a.name,a.data);h=null}function e(a){f.isFn(a.destroy)&&!a._destroyed&&(a.destroy(),a._destroyed=!0)}var f=Ca.getUtility("common"),g=[],h=[],i={},j=!1;a.dataProviders=a.dataProviders||{},this.createComponent=function(a){var b=Ca.createComponent(a,this);return b&&(b.componentName=a,g.push(b)),b},this.destroyComponent=function(a){var b,c;for(b=0,c=g.length;c>b;++b)if(a===g[b]){e(a),g.splice(b,1);break}},this.destroy=function(){var a,b,c,d=g.slice();for(a=0,b=d.length;b>a;++a)c=d[a],e(c);g=[],i={}},this.broadcast=function(a,b){j?c(a,b):h.push({name:a,data:b})},this.getUtility=function(a){return Ca.getUtility(a)},this.getConfig=function(){return a},this.ready=function(){j||(j=!0,d())},this.get=function(c,d){var e=a.dataProviders[c]||c,f=this.getDataProvider(e);return f?f.get(c,d):b.Deferred().reject("data-provider not found").promise()},this.getDataProvider=function(a){var b;return i[a]?b=i[a]:(b=this.createComponent("data-provider-"+a),i[a]=b),b}}}(),function(){function a(a,b){var c=!1;return{type:a,data:b,preventDefault:function(){c=!0},isDefaultPrevented:function(){return c}}}Ca.EventTarget=function(){this._handlers={}},Ca.EventTarget.prototype={constructor:Ca.EventTarget,on:function(a,b){"undefined"==typeof this._handlers[a]&&(this._handlers[a]=[]),this._handlers[a].push(b)},fire:function(b,c){var d,e,f,g=a(b,c);if(d=this._handlers[g.type],d instanceof Array)for(d=d.concat(),e=0,f=d.length;f>e;e++)d[e]&&d[e].call(this,g);if(d=this._handlers.all,d instanceof Array)for(d=d.concat(),e=0,f=d.length;f>e;e++)d[e]&&d[e].call(this,g);return g},off:function(a,b){var c,d,e=this._handlers[a];if(e instanceof Array){if(!b)return void(e.length=0);for(c=0,d=e.length;d>c;c++)if(e[c]===b||e[c].handler===b){e.splice(c,1);break}}},one:function(a,b){var c=this,d=function(e){c.off(a,d),b.call(c,e)};d.handler=b,this.on(a,d)}}}(),function(){var a=0,c={};Ca.Viewer=function(d,e){function f(){l.init()}Ca.EventTarget.call(this);var g,h=Ca.getUtility("common"),i=b(d),j=h.extend(!0,{},Ca.Viewer.defaults,e),k=new Ca.Scope(j),l=k.createComponent("viewer-base");if(0===i.length)throw new Error("Invalid container element");this.id=j.id=++a,j.api=this,j.$el=i,c[this.id]=this,this.destroy=function(){delete c[j.id],k.broadcast("destroy"),k.destroy()},this.load=function(){l.loadAssets()},this.setLayout=function(a){g=null,g=l.setLayout(a)},this.zoom=function(a){var b=parseFloat(a);g&&(b&&(a=b/(j.pageScale||1)),g.setZoom(a))},this.scrollTo=function(a){g&&h.isFn(g.scrollTo)&&g.scrollTo(a)},this.scrollBy=function(a,b){g&&g.scrollBy(a,b)},this.focus=function(){g&&g.focus()},this.enableTextSelection=function(){i.toggleClass(m,!1),j.enableTextSelection||(j.enableTextSelection=!0,k.broadcast("textenabledchange",{enabled:!0}))},this.disableTextSelection=function(){i.toggleClass(m,!0),j.enableTextSelection&&(j.enableTextSelection=!1,k.broadcast("textenabledchange",{enabled:!1}))},this.enableLinks=function(){j.enableLinks||(i.removeClass(n),j.enableLinks=!0)},this.disableLinks=function(){j.enableLinks&&(i.addClass(n),j.enableLinks=!1)},this.updateLayout=function(){g&&g.update()},f()},Ca.Viewer.prototype=new Ca.EventTarget,Ca.Viewer.prototype.constructor=Ca.Viewer,Ca.Viewer.get=function(a){return c[a]},Ca.Viewer.defaults={url:null,layout:X,zoom:S,page:1,enableTextSelection:!0,enableLinks:!0,enableDragging:!1,queryParams:null,plugins:{},useWindowAsViewport:!1,conversionIsComplete:!0,template:{svg:"page-{{page}}.svg",img:"page-{{page}}.png",html:"text-{{page}}.html",css:"stylesheet.css",json:"info.json"},dataProviders:{metadata:"metadata",stylesheet:"stylesheet","page-svg":"page-svg","page-text":"page-text","page-img":"page-img"},pageStart:null,pageEnd:null,autoloadFirstPage:!0,zoomLevels:[.25,.5,.75,1,1.25,1.5,2,3]}}(),Ca.addDataProvider("metadata",function(a){function b(a){return d.parseJSON(a)}var c=a.getUtility("ajax"),d=a.getUtility("common"),e=a.getConfig();return{get:function(){var a=this.getURL(),d=c.fetch(a,Ca.ASSET_REQUEST_RETRIES);return d.then(b).promise({abort:d.abort})},getURL:function(){var a=e.template.json;return e.url+a+e.queryString}}}),Ca.addDataProvider("page-img",function(a){var c=a.getUtility("common"),d=a.getConfig();return{get:function(a,c){function d(){f.setAttribute("src",i)}function e(){f&&f.removeAttribute("src")}var f=this.getImage(),g=Ca.ASSET_REQUEST_RETRIES,h=!1,i=this.getURL(c),j=b.Deferred();return f.onload=function(){h=!0,j.resolve(f)},f.onerror=function(){g>0?(g--,e(),d()):(f=null,h=!1,j.reject({error:"image failed to load",resource:i}))},d(),j.promise({abort:function(){h||(e(),j.reject())}})},getURL:function(a){var b=c.template(d.template.img,{page:a});return d.url+b+d.queryString},getImage:function(){return new Image}}}),Ca.addDataProvider("page-svg",function(a){function b(a,b){var c="<style>"+b+"</style>";return g.firefox&&!h.isSubpxSupported()&&(c+="<style>text { text-rendering: geometricPrecision; }</style>"),a=a.replace(l,c)}function c(c){if(!j){var f,g=i.queryString.replace("&","&#38;");return f=e.countInStr(c,'xlink:href="data:image'),f>d&&(c=c.replace(/<image[\s\w-_="]*xlink:href="data:image\/[^"]{0,5120}"[^>]*>/gi,"")),c=c.replace(/href="([^"#:]*)"/g,function(a,b){return'href="'+i.url+b+g+'"'}),a.get("stylesheet").then(function(a){return b(c,a)})}}var d=1e3,e=a.getUtility("common"),f=a.getUtility("ajax"),g=a.getUtility("browser"),h=a.getUtility("subpx"),i=a.getConfig(),j=!1,k={},l=/<xhtml:link[^>]*>(\s*<\/xhtml:link>)?/i;return{get:function(a,b){var d,e=this.getURL(b);return k[b]?k[b]:(d=f.fetch(e,Ca.ASSET_REQUEST_RETRIES),k[b]=d.then(c).promise({abort:function(){d.abort(),k&&delete k[b]}}),k[b])},getURL:function(a){var b=e.template(i.template.svg,{page:a});return i.url+b+i.queryString},destroy:function(){j=!0,e=f=h=g=i=k=null}}}),Ca.addDataProvider("page-text",function(a){function b(a){if(!g){var b=d.countInStr(a,"<div");return b>c?"":a=a.replace(/<link rel="stylesheet".*/,"")}}var c=256,d=a.getUtility("common"),e=a.getUtility("ajax"),f=a.getConfig(),g=!1,h={};return{get:function(a,c){var d,f=this.getURL(c);return h[c]?h[c]:(d=e.fetch(f,Ca.ASSET_REQUEST_RETRIES),h[c]=d.then(b).promise({abort:function(){d.abort(),h&&delete h[c]}}),h[c])},getURL:function(a){var b=d.template(f.template.html,{page:a});return f.url+b+f.queryString},destroy:function(){g=!0,d=e=f=h=null}}}),Ca.addDataProvider("stylesheet",function(a){function b(a){return e.ie&&(a=a.replace(/font-family:[\s\"\']*([\w-]+)\b/g,"$0-"+f.id)),a}var c,d=a.getUtility("ajax"),e=a.getUtility("browser"),f=a.getConfig();return{get:function(){if(c)return c;var a=d.fetch(this.getURL(),Ca.ASSET_REQUEST_RETRIES);return c=a.then(b).promise({abort:function(){a.abort(),c=null}})},getURL:function(){var a=f.template.css;return f.url+a+f.queryString},destroy:function(){d=e=f=null,c=null}}}),Ca.addUtility("ajax",function(a){function c(a){var b,c,d;try{b=a.status,c=a.statusText,d=a.responseText}catch(e){b=0,c="",d=null}return{status:b,statusText:c,responseText:d,rawRequest:a}}function d(a){return"file:"===l.parse(a).protocol}function e(a){return a>=200&&300>a||304===a}function f(a){return a=j.extend(!0,{},a||{}),a.method=a.method||"GET",a.headers=a.headers||[],a.data=a.data||"","string"!=typeof a.data&&(a.data=b.param(a.data),"GET"!==a.method&&(a.data=a.data,a.headers.push(["Content-Type","application/x-www-form-urlencoded"]))),a}function g(a,b){var c;for(c=0;c<b.length;++c)a.setRequestHeader(b[c][0],b[c][1])}function h(a,b,c,f,h,i){var j=k.getXHR();return j.open(b,a,!0),j.onreadystatechange=function(){var b;if(4===j.readyState){j.onreadystatechange=function(){};try{b=j.status}catch(c){return void i(j)}0===b&&d(a)&&(b=200),e(b)?h(j):i(j)}},g(j,f),j.send(c),j}function i(a,b,c,d,e){var f=k.getXDR();try{f.open(b,a),f.onload=function(){d(f)},f.onerror=function(){e(f)},f.ontimeout=function(){e(f)},f.onprogress=function(){},f.send(c)}catch(g){return e({status:0,statusText:g.message})}return f}var j=a.getUtility("common"),k=a.getUtility("support"),l=a.getUtility("url");return{request:function(a,b){function d(a){return j.isFn(g.success)&&g.success.call(c(a)),a}function e(a){return j.isFn(g.fail)&&g.fail.call(c(a)),a}var g=f(b),m=g.method,n=g.data,o=g.headers;return"GET"===m&&n&&(a=l.appendQueryParams(a,n),n=""),k.isXHRSupported()?l.isCrossDomain(a)&&!k.isCORSSupported()?i(a,m,n,d,e):h(a,m,n,o,d,e):g.fail({status:0,statusText:"AJAX not supported"})},fetch:function(a,c){function d(a){c>0?(c--,f=e()):i.reject(a)}function e(){return h.request(a,{success:function(){var b,c;if(!g){if(c=this.rawRequest,202===this.status&&j.isFn(c.getResponseHeader)&&(b=parseInt(c.getResponseHeader("retry-after")),b>0))return void setTimeout(e,1e3*b);this.responseText?i.resolve(this.responseText):d({error:"empty response",status:this.status,resource:a})}},fail:function(){g||d({error:this.statusText,status:this.status,resource:a})}})}var f,g=!1,h=this,i=b.Deferred();return f=e(),i.promise({abort:function(){g=!0,f.abort()}})}}}),Ca.addUtility("browser",function(){var a,b=navigator.userAgent,c={},d=/ip(hone|od|ad)/i.test(b),e=/android/i.test(b),f=/blackberry/i.test(b),g=/webos/i.test(b),h=/silk|kindle/i.test(b),i=/MSIE|Trident/i.test(b);return i&&(c.ie=!0,a=/MSIE/i.test(b)?/MSIE\s+(\d+\.\d+)/i.exec(b):/Trident.*rv[ :](\d+\.\d+)/.exec(b),c.version=a&&parseFloat(a[1]),c.ielt9=c.version<9,c.ielt10=c.version<10,c.ielt11=c.version<11),d&&(c.ios=!0,a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c.version=a&&parseFloat(a[1]+"."+a[2])),c.mobile=/mobile/i.test(b)||d||e||f||g||h,c.firefox=/firefox/i.test(b),/safari/i.test(b)&&(c.chrome=/chrome/i.test(b),c.safari=!c.chrome),c.safari&&(a=navigator.appVersion.match(/Version\/(\d+(\.\d+)?)/),c.version=a&&parseFloat(a[1])),c}),Ca.addUtility("common",function(){var c=1.33333,d={};return d.extend=b.extend,d.each=b.each,d.map=b.map,d.param=b.param,d.parseJSON=b.parseJSON,d.stringifyJSON="undefined"!=typeof a.JSON?a.JSON.stringify:function(){throw new Error("JSON.stringify not supported")},b.extend(d,{bisectLeft:function(a,b,c){for(var d,e,f=0,g=a.length;g>f;)e=Math.floor((f+g)/2),d=c?a[e][c]:a[e],b>d?f=e+1:g=e;return f},bisectRight:function(a,b,c){for(var d,e,f=0,g=a.length;g>f;)e=Math.floor((f+g)/2),d=c?a[e][c]:a[e],d>b?g=e:f=e+1;return f},clamp:function(a,b,c){return b>a?b:a>c?c:a},sign:function(a){var b=parseInt(a,10);return b?0>b?-1:1:b},isFn:function(a){return"function"==typeof a},inArray:function(a,c){return d.isFn(c.indexOf)?c.indexOf(a):b.inArray(a,c)},constrainRange:function(a,b,c){var e=b-a;return 0>e?{min:-1,max:-1}:(a=d.clamp(a,0,c),b=d.clamp(a+e,0,c),e>b-a&&(a=d.clamp(b-e,0,c)),{min:a,max:b})},now:function(){return(new Date).getTime()},throttle:function(a,b){function c(){i=d.now(),g=null,h=b.apply(e,f)}var e,f,g,h,i=0;return function(){var j=d.now(),k=a-(j-i);return e=this,f=arguments,0>=k?(clearTimeout(g),g=null,i=j,h=b.apply(e,f)):g||(g=setTimeout(c,k)),h}},debounce:function(a,b){function c(){var j=d.now()-h;a>j?g=setTimeout(c,a-j):(g=null,i=b.apply(e,f),e=f=null)}var e,f,g,h,i;return function(){return e=this,f=arguments,h=d.now(),g||(g=setTimeout(c,a)),i}},insertCSS:function(a){var b=document.createElement("style"),c=document.createTextNode(a);try{b.setAttribute("type","text/css"),b.appendChild(c)}catch(d){}return document.getElementsByTagName("head")[0].appendChild(b),b},appendCSSRule:function(a,b,c){var d;return a.insertRule?a.insertRule(b+"{"+c+"}",a.cssRules.length):(d=a.addRule(b,c,a.rules.length),0>d&&(d=a.rules.length-1),d)},deleteCSSRule:function(a,b){a.deleteRule?a.deleteRule(b):a.removeRule(b)},getSelectedNode:function(){var b,c,d;return a.getSelection?(c=a.getSelection(),c.rangeCount&&(d=c.getRangeAt(0),d.collapsed||(b=c.anchorNode.parentNode))):document.selection&&(b=document.selection.createRange().parentElement()),b},getComputedStyle:function(b){return"getComputedStyle"in a?a.getComputedStyle(b):b.currentStyle},calculatePtSize:function(){var a,b,e=1e4,f=document.createElement("div");return f.style.display="block",f.style.position="absolute",f.style.width=e+"pt",document.body.appendChild(f),a=d.getComputedStyle(f),b=a&&a.width?parseFloat(a.width)/e:c,document.body.removeChild(f),b},countInStr:function(a,b){for(var c,d=0;c=a.indexOf(b,c)+1;)d++;return d},template:function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a=a.replace(new RegExp("\\{\\{"+c+"\\}\\}","g"),b[c]));return a}})}),Ca.addUtility("subpx",function(c){function d(){if(!b.support.leadingWhitespace)return!1;var c=b(g.template(f,{size:12.5})).appendTo(document.documentElement).get(0),d=b(c).css("font-size"),e=b(c).width();b(c).remove(),c=b(g.template(f,{size:12.6})).appendTo(document.documentElement).get(0);var h=b(c).css("font-size"),i=b(c).width();if(b(c).remove(),!("ontouchstart"in a)){if(d===h)return!1;if(e===i)return!1}return!0}var e="crocodoc-subpx-fix",f='<span style="font:{{size}}px serif; color:transparent; white-space:nowrap;">'+new Array(100).join("A")+"</span>",g=c.getUtility("common"),h=d();return{fix:function(a){if(!h&&void 0!==document.body.style.zoom){var c=b("<div>").addClass(e);b(a).wrap(c)}return a},isSubpxSupported:function(){return h}}}),Ca.addUtility("support",function(){function b(a){var b,e,f,g=document.createElement("div");if(a in g.style)return a;if(b=a.charAt(0).toUpperCase()+a.substr(1),a in g.style)return a;for(e=0;e<d.length;++e)if(f=d[e]+b,f in g.style)return 0===f.indexOf("ms")&&(f="-"+f),c(f);return!1}function c(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}var d=["Moz","Webkit","O","ms"],e=null,f=null;return{svg:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),csstransform:b("transform"),csstransition:b("transition"),csszoom:b("zoom"),isXHRSupported:function(){return null===e&&(e=!!this.getXHR()),e},isCORSSupported:function(){return null===f&&(f=this.isXHRSupported()&&"withCredentials"in this.getXHR()),f},isXDRSupported:function(){return"undefined"!=typeof a.XDomainRequest},getXHR:function(){if(a.XMLHttpRequest)return new a.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(b){return null}},getXDR:function(){return this.isXDRSupported()?new a.XDomainRequest:null}}}),Ca.addUtility("url",function(b){var c,d=b.getUtility("browser");return{getCurrentURL:function(){return a.location.href},makeAbsolute:function(a){return this.parse(a).href},isCrossDomain:function(a){var b=this.parse(a);return c||(c=this.parse(this.getCurrentURL())),b.hostname?b.protocol!==c.protocol||b.hostname!==c.hostname||b.port!==c.port:!1},appendQueryParams:function(a,b){return a.indexOf("?")>-1?a+"&"+b:a+"?"+b},parse:function(a){var b,c=document.createElement("a");return c.href=a,d.ie&&a!==c.href&&(a=c.href,c.href=a),b=c.pathname,/^\//.test(b)||(b="/"+b),{href:c.href,protocol:c.protocol,host:c.host,hostname:c.hostname,port:c.port,pathname:b,hash:c.hash,search:c.search}}}}),Ca.addComponent("controller-paged",function(a){function c(){var a=j.metadata;j.numPages=a.numpages,j.pageStart?j.pageStart<0&&(j.pageStart=a.numpages+j.pageStart):j.pageStart=1,j.pageStart=n.clamp(j.pageStart,1,a.numpages),j.pageEnd?j.pageEnd<0&&(j.pageEnd=a.numpages+j.pageEnd):j.pageEnd=a.numpages,j.pageEnd=n.clamp(j.pageEnd,j.pageStart,a.numpages),j.numPages=j.pageEnd-j.pageStart+1}function d(){var a,c,d,e,f,g,h,i,k=n.calculatePtSize(),l=j.metadata.dimensions,m="";for(j.pageScale=P/(l.width*k),d=j.zoomLevels[j.zoomLevels.length-1],e=3/j.pageScale;e>d;)d+=d/2,j.zoomLevels.push(d);for(l.exceptions=l.exceptions||{},a=j.pageStart-1;a<j.pageEnd;a++)c=a+1,c in l.exceptions?(f=l.exceptions[c].width,g=l.exceptions[c].height):(f=l.width,g=l.height),h=f*k,i=g*k,h*=j.pageScale,i*=j.pageScale,m+=n.template(Ca.pageTemplate,{w:h,h:i});j.$pages=b(m).appendTo(j.$doc)}function e(a){return j.conversionIsComplete||0===a&&j.autoloadFirstPage?ca:ba}function f(){var b,c,d=[],f=j.pageStart-1,h=j.pageEnd,i=g();for(b=f;h>b;b++)c=a.createComponent("page"),c.init(j.$pages.eq(b-f),{index:b,status:e(b),enableLinks:j.enableLinks,links:i[b],pageScale:j.pageScale,useSVG:j.useSVG}),d.push(c);j.pages=d}function g(){var a,b,c,d,e=j.pageStart,f=j.pageEnd,g=j.metadata.links||[],h=[];for(a=0,b=j.metadata.numpages;b>a;++a)h[a]=[];for(a=0,b=g.length;b>a;++a)if(c=g[a],!(c.pagenum<e||c.pagenum>f)){if(c.destination){if(d=c.destination.pagenum,e>d||d>f)continue;c.destination.pagenum=d-(e-1)}h[c.pagenum-1].push(c)}return h}function h(){i()}function i(){var a=n.getSelectedNode(),c=b(a).closest("."+v);k.find("."+l).removeClass(l),a&&k.has(a)&&c.addClass(l)}var j,k,m,n=a.getUtility("common");return{init:function(){j=a.getConfig(),k=j.$el,b(document).on("mouseup",h),c(),d(),f(),m=a.createComponent("lazy-loader"),m.init(j.pages)},destroy:function(){b(document).off("mouseup",h)}}}),Ca.addComponent("controller-text",function(a){var c;return{init:function(){var d=a.getConfig();d.$textContainer=b(),c=a.get("page-text",1).then(function(a){var c=d.$doc.parent();d.$doc=b(a),c.html(d.$doc)})},destroy:function(){c.abort()}}}),Ca.addComponent("dragger",function(c){function d(a){g.scrollTop(h.top-(a.clientY-i.y)),g.scrollLeft(h.left-(a.clientX-i.x)),a.preventDefault()}function e(a){c.broadcast("dragend"),j.off("mousemove",d),j.off("mouseup",e),a.preventDefault()}function f(a){c.broadcast("dragstart"),h={top:g.scrollTop(),left:g.scrollLeft()},i={x:a.clientX,y:a.clientY},j.on("mousemove",d),j.on("mouseup",e),a.preventDefault()}var g,h,i,j=b(a);return{init:function(a){g=b(a),g.on("mousedown",f)},destroy:function(){g.off("mousedown",f),g.off("mousemove",d),j.off("mouseup",e)}}}),Ca.addComponent("layout-base",function(b){var c=b.getUtility("common");return{messages:["resize","scroll","scrollend"],onmessage:function(a,b){switch(a){case"resize":this.handleResize(b);break;case"scroll":this.handleScroll(b);break;case"scrollend":this.handleScrollEnd(b)}},init:function(){var a=b.getConfig();this.config=a,this.$el=a.$el,this.$doc=a.$doc,this.$viewport=a.$viewport,this.$pages=a.$pages,this.numPages=a.numPages,this.layoutClass=s+a.layout,this.$el.addClass(this.layoutClass),this.initState()},initState:function(){var b=this.$viewport[0],c=b;b===a&&(c=document.documentElement),this.state={scrollTop:b.scrollTop,scrollLeft:b.scrollLeft,viewportDimensions:{clientWidth:c.clientWidth,clientHeight:c.clientHeight,offsetWidth:c.offsetWidth,offsetHeight:c.offsetHeight},zoomState:{zoom:1,prevZoom:0,zoomMode:null},initialWidth:0,initialHeight:0,totalWidth:0,totalHeight:0},this.zoomLevels=[]},destroy:function(){this.$doc.removeAttr("style"),this.$el.removeClass(this.layoutClass)},setZoom:function(){},calculateNextZoomLevel:function(a){var b,c=!1,d=this.state.zoomState.zoom,e=this.zoomLevels;if(a===Ca.ZOOM_IN){for(b=0;b<e.length;++b)if(e[b]>d){c=e[b];break}}else if(a===Ca.ZOOM_OUT)for(b=e.length-1;b>=0;--b)if(e[b]<d){c=e[b];break}return c},isDraggable:function(){var a=this.state;return a.viewportDimensions.clientHeight<a.totalHeight||a.viewportDimensions.clientWidth<a.totalWidth},scrollBy:function(a,b){a=parseInt(a,10)||0,b=parseInt(b,10)||0,this.scrollToOffset(a+this.state.scrollLeft,b+this.state.scrollTop)},scrollToOffset:function(a,b){this.$viewport.scrollLeft(a),this.$viewport.scrollTop(b)},handleScroll:function(a){this.state.scrollTop=a.scrollTop,this.state.scrollLeft=a.scrollLeft},handleResize:function(){},handleScrollEnd:function(){},update:function(){},focus:function(){this.$viewport.focus()},extend:function(a){return c.extend({},this,a)}}}),Ca.addComponent("layout-"+Z,["layout-paged"],function(a,b){var c=a.getUtility("common"),d=a.getUtility("browser");return b.extend({calculateZoomAutoValue:function(){var a=this.state,b=this.calculateZoomValue(Q),c=this.calculateZoomValue(R);return a.widestPage.actualWidth>a.tallestPage.actualHeight?Math.min(b,c):d.mobile?c:Math.min(1,c)},calculateCurrentPage:function(){var a,b,d=this.state,e=d.pages;return a=c.bisectRight(e,d.scrollLeft,"x0")-1,b=c.bisectRight(e,d.scrollLeft+e[a].width/2,"x0")-1,1+b},calculateNextPage:function(){return this.state.currentPage+1},calculatePreviousPage:function(){return this.state.currentPage-1},handleResize:function(a){b.handleResize.call(this,a),this.updateCurrentPage()},handleScroll:function(a){b.handleScroll.call(this,a),this.updateCurrentPage()},updateLayout:function(){var a=this.state,b=a.zoomState,c=b.zoom,d=a.sumWidths,e=Math.floor(a.tallestPage.totalActualHeight*c),f=Math.max(d,a.viewportDimensions.clientWidth),g=Math.max(e,a.viewportDimensions.clientHeight);this.$doc.css({height:g,lineHeight:g+"px",width:f})}})}),Ca.addComponent("layout-paged",["layout-base"],function(a,b){function c(a,b){var c,d,g,h,i=a.state,j="."+a.config.namespace+" ."+C,k=a.config.stylesheet,l=i.pages,m=b*a.config.pageScale,n=100/m;for(h=f.csstransform?f.csstransform+":scale("+m+");width:"+n+"%;height:"+n+"%;":f.csszoom?"zoom:"+m:"",i.previousStyleIndex&&e.deleteCSSRule(k,i.previousStyleIndex),i.previousStyleIndex=e.appendCSSRule(k,j,h),c=0,d=l.length;d>c;++c)g=l[c],a.$pages.eq(c).css({width:g.actualWidth*b,height:g.actualHeight*b,paddingTop:g.paddingTop*b,paddingRight:g.paddingRight*b,paddingBottom:g.paddingBottom*b,paddingLeft:g.paddingLeft*b})}function d(a,b){if(!b||0===b.length)return 1/0;var c=e.map(b,function(b){return a[b].y1});return Math.max.apply(Math,c)}var e=a.getUtility("common"),f=a.getUtility("support");return b.extend({init:function(){b.init.call(this),this.updatePageStates(),this.updateZoomLevels()},initState:function(){b.initState.call(this),e.extend(this.state,{pages:[],widestPage:{index:0,actualWidth:0},tallestPage:{index:0,actualHeight:0},sumWidths:0,sumHeights:0,rows:[],currentPage:null,visiblePages:[],fullyVisiblePages:[]})},destroy:function(){b.destroy.call(this),this.$pages.css("padding","")},update:function(){this.updatePageStates(!0),this.setZoom()},setZoom:function(b){var c,d,f=this.state,g=this.parseZoomValue(b),h=f.zoomState,i=h.zoom;c=this.calculateZoomMode(b,g),g=e.clamp(g,f.minZoom,f.maxZoom),a.broadcast("beforezoom",e.extend({page:f.currentPage,visiblePages:e.extend([],f.visiblePages),fullyVisiblePages:e.extend([],f.fullyVisiblePages)},h)),h.prevZoom=i,h.zoom=g,h.zoomMode=c,this.applyZoom(g),h.canZoomIn=this.calculateNextZoomLevel(Ca.ZOOM_IN)!==!1,h.canZoomOut=this.calculateNextZoomLevel(Ca.ZOOM_OUT)!==!1,this.updatePageStates(),this.updateLayout(),d=b===Ca.ZOOM_AUTO||b===Ca.ZOOM_FIT_WIDTH||b===Ca.ZOOM_FIT_HEIGHT,this.updateScrollPosition(d),this.updatePageStates(),this.updateVisiblePages(!0),a.broadcast("zoom",e.extend({page:f.currentPage,visiblePages:e.extend([],f.visiblePages),fullyVisiblePages:e.extend([],f.fullyVisiblePages),isDraggable:this.isDraggable()},h))},parseZoomValue:function(a){var b=parseFloat(a),c=this.state,d=c.zoomState,e=d.zoom,f=e;if(b)f=b;else switch(a){case Ca.ZOOM_FIT_WIDTH:case Ca.ZOOM_FIT_HEIGHT:case Ca.ZOOM_AUTO:f=this.calculateZoomValue(a);break;case Ca.ZOOM_IN:case Ca.ZOOM_OUT:f=this.calculateNextZoomLevel(a)||e;break;default:f=e?d.zoomMode?this.calculateZoomValue(d.zoomMode):e:this.calculateZoomValue(this.config.zoom||Ca.ZOOM_AUTO)}return f},calculateZoomMode:function(a,b){switch(b){case this.calculateZoomValue(Ca.ZOOM_AUTO):return"string"!=typeof a||a!==Ca.ZOOM_FIT_WIDTH&&a!==Ca.ZOOM_FIT_HEIGHT?Ca.ZOOM_AUTO:a;case this.calculateZoomValue(Ca.ZOOM_FIT_WIDTH):return Ca.ZOOM_FIT_WIDTH;case this.calculateZoomValue(Ca.ZOOM_FIT_HEIGHT):return Ca.ZOOM_FIT_HEIGHT;default:return null}},updateZoomLevels:function(){function a(a){var b=c/a;return a===c?!1:la>b?!0:e.inArray(a,i)>-1&&ma>b?!0:!1}var b,c,d=this.config.zoomLevels.slice()||[1],f=this.calculateZoomValue(Ca.ZOOM_AUTO),g=this.calculateZoomValue(Ca.ZOOM_FIT_WIDTH),h=this.calculateZoomValue(Ca.ZOOM_FIT_HEIGHT),i=[g,h];for(this.state.minZoom=this.config.minZoom||d[0],this.state.maxZoom=this.config.maxZoom||d[d.length-1],f!==g&&f!==h&&i.push(f),d=d.concat(i),d.sort(function(a,b){return a-b}),this.zoomLevels=[],c=0,b=0;b<d.length;++b)a(d[b])&&(c=d[b],this.zoomLevels.push(c))},calculateZoomValue:function(a){var b=this.state,c=parseFloat(a);return c?c:a===Ca.ZOOM_FIT_WIDTH?b.viewportDimensions.clientWidth/b.widestPage.totalActualWidth:a===Ca.ZOOM_FIT_HEIGHT?b.viewportDimensions.clientHeight/b.tallestPage.totalActualHeight:a===Ca.ZOOM_AUTO?this.calculateZoomAutoValue():b.zoomState.zoom},applyZoom:function(a){c(this,a)},scrollTo:function(a){var b=this.state,c=parseInt(a,10);if("string"==typeof a){if(a===Ca.SCROLL_PREVIOUS&&b.currentPage>1)c=this.calculatePreviousPage();else if(a===Ca.SCROLL_NEXT&&b.currentPage<this.numPages)c=this.calculateNextPage();else if(!c)return}else if(!c&&0!==c)return;c=e.clamp(c,1,this.numPages),this.scrollToPage(c)},scrollToPage:function(a){var b=this.calculateScrollPositionForPage(a);this.scrollToOffset(b.left,b.top)},calculateCurrentPage:function(){return this.state.currentPage},calculateScrollPositionForPage:function(a){var b=e.clamp(a-1,0,this.numPages-1),c=this.state.pages[b];return{top:c.y0,left:c.x0}},calculateVisibleRange:function(){var a=this.state,b=a.pages,c=a.viewportDimensions.clientHeight,d=a.viewportDimensions.clientWidth;if(0===d||0===c)return{min:-1,max:-1};var f=a.scrollTop,g=f+c,h=a.scrollLeft,i=h+d,j=e.bisectLeft(b,f,"y1"),k=e.bisectRight(b,g,"y0")-1,l=e.bisectLeft(b,h,"x1"),m=e.bisectRight(b,i,"x0")-1,n=Math.max(l,j),o=Math.min(m,k);return e.constrainRange(n,o,this.numPages-1)},calculateFullyVisibleRange:function(){var a=this.state,b=a.pages,c=a.viewportDimensions.clientHeight,d=a.viewportDimensions.clientWidth;if(0===d||0===c)return{min:-1,max:-1};var f=a.scrollTop,g=f+c,h=a.scrollLeft,i=h+d,j=e.bisectLeft(b,f,"y0"),k=e.bisectRight(b,g,"y1")-1,l=e.bisectLeft(b,h,"x0"),m=e.bisectRight(b,i,"x1")-1,n=Math.max(l,j),o=Math.min(m,k);return e.constrainRange(n,o,this.numPages-1)},setCurrentPage:function(b){var c=this.state;c.currentPage!==b?(c.currentPage=b,this.updateVisiblePages(),a.broadcast("pagefocus",{page:c.currentPage,numPages:this.numPages,visiblePages:e.extend([],c.visiblePages),fullyVisiblePages:e.extend([],c.fullyVisiblePages)})):this.updateVisiblePages()},updateVisiblePages:function(a){var b,c,d,e=this.state,f=this.calculateVisibleRange(),g=this.calculateFullyVisibleRange();for(e.visiblePages.length=0,e.fullyVisiblePages.length=0,b=0,c=this.$pages.length;c>b;++b)d=this.$pages.eq(b),b<f.min||b>f.max?a&&d.hasClass(F)&&d.removeClass(F):(a&&!d.hasClass(F)&&d.addClass(F),e.visiblePages.push(b+1)),b>=g.min&&b<=g.max&&e.fullyVisiblePages.push(b+1)},updatePageStates:function(a){var b,c,e,f,g,h=this.state,i=h.pages,j=h.rows,k=this.$viewport.scrollTop(),l=this.$viewport.scrollLeft(),m=0,n=0,o=0,p=0;for(j.length=h.sumWidths=h.sumHeights=h.totalWidth=h.totalHeight=0,h.widestPage.totalActualWidth=h.tallestPage.totalActualHeight=0,b=0,c=this.$pages.length;c>b;++b)g=this.$pages.eq(b),f=g[0],e=i[b],(!e||a)&&(g.css("padding",""),e={index:b,paddingLeft:parseFloat(g.css(ja)),paddingRight:parseFloat(g.css(ia)),paddingTop:parseFloat(g.css(ha)),paddingBottom:parseFloat(g.css(ka))}),e.actualWidth||(e.actualWidth=parseFloat(f.getAttribute("data-width"))),e.actualHeight||(e.actualHeight=parseFloat(f.getAttribute("data-height"))),e.totalActualWidth=e.actualWidth+e.paddingLeft+e.paddingRight,e.totalActualHeight=e.actualHeight+e.paddingTop+e.paddingBottom,e.width=f.offsetWidth,e.height=f.offsetHeight,e.x0=f.offsetLeft,e.y0=f.offsetTop,e.x1=e.width+e.x0,e.y1=e.height+e.y0,n&&d(i,j[m])<=e.y0+2&&m++,n=e.y1,j[m]||(j[m]=[]),e.totalActualWidth>h.widestPage.totalActualWidth&&(h.widestPage=e),e.totalActualHeight>h.tallestPage.totalActualHeight&&(h.tallestPage=e),h.sumWidths+=e.width,h.sumHeights+=e.height,e.rowIndex=m,i[b]=e,j[m].push(b),i[o].x0+i[o].width<e.x0+e.width&&(o=b),i[p].y0+i[p].height<e.y0+e.height&&(p=b);h.totalWidth=i[o].x0+i[o].width,h.totalHeight=i[p].y0+i[p].height,h.scrollTop=k,h.scrollLeft=l,this.setCurrentPage(this.calculateCurrentPage())},updateCurrentPage:function(){var a=this.calculateCurrentPage();this.setCurrentPage(a)},handleResize:function(a){var b=this.state.zoomState.zoomMode;this.state.viewportDimensions=a,this.updateZoomLevels(),this.setZoom(b)},handleScrollEnd:function(a){this.$doc.find("."+t).removeClass(t),this.$pages.eq(this.state.currentPage-1).addClass(t),this.updateVisiblePages(!0),this.handleScroll(a)},updateScrollPosition:function(a){var b,c,d=this.state,e=d.zoomState,f=e.zoom/e.prevZoom;b=d.scrollLeft*f,c=d.scrollTop*f,a!==!0&&(c+=d.viewportDimensions.offsetHeight*(f-1)/2,b+=d.viewportDimensions.offsetWidth*(f-1)/2),this.scrollToOffset(b,c)},updateLayout:function(){},calculateZoomAutoValue:function(){return 1},calculateNextPage:function(){return 1},calculatePreviousPage:function(){return 1}})}),Ca.addComponent("layout-"+_,["layout-"+$],function(a,b){var c=a.getUtility("common");

return b.extend({init:function(){this.twoPageMode=!0,b.init.call(this)},calculateNextPage:function(){return this.state.currentPage+2},calculatePreviousPage:function(){return this.state.currentPage-2},calculateZoomValue:function(a){var c=b.calculateZoomValue.call(this,a);return a===Q&&(c/=2),c},scrollToPage:function(a){b.scrollToPage.call(this,a-(a+1)%2)},calculateVisibleRange:function(){var a=this.state.currentPage-1,b=a+1;return c.constrainRange(a,b,this.numPages)},calculateFullyVisibleRange:function(){return this.calculateVisibleRange()}})}),Ca.addComponent("layout-"+$,["layout-paged"],function(a,b){var c=a.getUtility("common");return b.extend({init:function(){b.init.call(this),this.updatePageMargins(),this.updatePageClasses()},destroy:function(){b.destroy.call(this),this.$pages.css({margin:"",left:""}).removeClass(M)},calculateZoomAutoValue:function(){var a=this.calculateZoomValue(Q),b=this.calculateZoomValue(R);return Math.min(a,b)},calculateCurrentPage:function(){return this.state.currentPage},calculateNextPage:function(){return this.state.currentPage+1},calculatePreviousPage:function(){return this.state.currentPage-1},calculateVisibleRange:function(){var a=this.state.currentPage-1;return c.constrainRange(a,a,this.numPages)},calculateFullyVisibleRange:function(){return this.calculateVisibleRange()},setCurrentPage:function(a){var d,e,f=c.clamp(a-1,0,this.numPages);b.setCurrentPage.call(this,a),this.$doc.find("."+u).removeClass(u),d=this.$doc.find("."+t),e=this.$pages.eq(f),d[0]!==e[0]&&(d.addClass(u).removeClass(t),e.addClass(t)),this.updateVisiblePages(!0),this.updatePageClasses(f)},scrollToPage:function(a){this.setCurrentPage(a)},updateLayout:function(){var a,b,c,d,e,f,g,h=this.state,i=h.zoomState,j=i.zoom,k=this.currentPage||1,l=h.pages[k-1],m=this.twoPageMode?h.pages[k]:l,n=h.viewportDimensions.clientWidth,o=h.viewportDimensions.clientHeight;a=m.actualWidth,b=l.actualWidth+(this.twoPageMode?a:0),c=l.actualHeight,d=Math.floor((b+l.paddingLeft+m.paddingRight)*j),e=Math.floor(l.totalActualHeight*j),f=Math.max(d,n),g=Math.max(e,o),this.$doc.css({width:f,height:g}),this.updatePageMargins(),f>n||g>o?this.$el.addClass("crocodoc-scrollable"):this.$el.removeClass("crocodoc-scrollable")},updatePageMargins:function(){var a,b,c,d,e,f,g,h,i,j=this.state,k=j.viewportDimensions.clientWidth,l=j.viewportDimensions.clientHeight;for(a=0,b=this.$pages.length;b>a;++a)d=this.$pages.eq(a),c=j.pages[a],i=this.twoPageMode?a%2===1?c.paddingRight:c.paddingLeft:c.paddingRight+c.paddingLeft,e=(c.actualWidth+i)*j.zoomState.zoom,f=(c.actualHeight+c.paddingTop+c.paddingBottom)*j.zoomState.zoom,this.twoPageMode?(g=Math.max(0,(k-2*e)/2),a%2===1&&(g+=e)):g=(k-e)/2,h=(l-f)/2,g=Math.max(g,0),h=Math.max(h,0),d.css({marginLeft:g,marginTop:h})},updatePageClasses:function(){var a=this.$pages,b=this.state.currentPage-1,c=b+1,d=b-1,e=20;a.removeClass(M),this.twoPageMode?(c=b+2,d=b-2,a.slice(Math.max(d,0),b).addClass(G),a.slice(c,c+2).addClass(H)):(d>=0&&a.eq(d).addClass(G),c<this.numPages&&a.eq(c).addClass(H)),a.slice(0,b).addClass(I),a.slice(Math.max(0,b-e),b).addClass(K),a.slice(c).addClass(J),a.slice(c,Math.min(this.numPages,c+e)).addClass(L)}})}),Ca.addComponent("layout-"+aa,["layout-base"],function(a,b){var c=a.getUtility("common");return b.extend({init:function(){b.init.call(this),this.zoomLevels=this.config.zoomLevels.slice(),this.minZoom=this.zoomLevels[0],this.maxZoom=this.zoomLevels[this.zoomLevels.length-1]},setZoom:function(b){var d,e=this.state.zoomState,f=e.zoom;"string"==typeof b?(d=this.calculateNextZoomLevel(b),d||(d="auto"===b||"fitwidth"===b||"fitheight"===b?1:f)):d=parseFloat(b)||f,d=c.clamp(d,this.minZoom,this.maxZoom),this.config.$doc.css("font-size",10*d+"pt"),e.prevZoom=f,e.zoom=d,e.canZoomIn=this.calculateNextZoomLevel(Ca.ZOOM_IN)!==!1,e.canZoomOut=this.calculateNextZoomLevel(Ca.ZOOM_OUT)!==!1,a.broadcast("zoom",c.extend({isDraggable:this.isDraggable()},e))}})}),Ca.addComponent("layout-"+Y,["layout-"+X],function(a,b){return b}),Ca.addComponent("layout-"+X,["layout-paged"],function(a,b){var c=a.getUtility("common"),d=a.getUtility("browser");return b.extend({calculateZoomAutoValue:function(){var a=this.state,b=this.calculateZoomValue(Q),c=this.calculateZoomValue(R);return a.widestPage.actualWidth>a.tallestPage.actualHeight?Math.min(1,b,c):d.mobile?b:Math.min(1,b)},calculateCurrentPage:function(){var a,b,d,e,f,g=this.state,h=g.pages;return a=c.bisectRight(h,g.scrollTop,"y0")-1,0>a?1:(f=g.scrollTop+h[a].height/2,b=c.bisectRight(h,f,"y0")-1,d=h[b].rowIndex,e=g.rows[d],1+e[0])},calculateNextPage:function(){var a=this.state,b=a.pages[a.currentPage-1],c=b.rowIndex,d=a.rows[c+1];return d&&d[0]+1||a.currentPage},calculatePreviousPage:function(){var a=this.state,b=a.pages[a.currentPage-1],c=b.rowIndex,d=a.rows[c-1];return d&&d[0]+1||a.currentPage},handleResize:function(a){b.handleResize.call(this,a),this.updateCurrentPage()},handleScroll:function(a){b.handleScroll.call(this,a),this.updateCurrentPage()},updateLayout:function(){var a,b,c=this.state,d=c.zoomState.zoom;a=Math.floor(c.widestPage.totalActualWidth*d),b=a<=c.viewportDimensions.clientWidth?"auto":a,this.$doc.css({width:b})}})}),Ca.addComponent("lazy-loader",function(a){function c(a){a=a||w;var b=A.page-1,c=b-a,d=b+a;return s.constrainRange(c,d,o-1)}function d(){var a;clearTimeout(r),v.length>0?(a=v.shift(),n[a]?u.loadPage(a,function(a){a===!1?d():r=setTimeout(d,na)}):d()):f()}function e(){clearTimeout(r),x=!1,r=setTimeout(d,na)}function f(){clearTimeout(r),x=!0}function g(a){v.push(a),x&&e()}function h(){v.length=0,f()}function i(a,b){var d=c(b);return a>=d.min&&a<=d.max?!0:!1}function j(a){var b=n[a];if(b){if(i(a))return!0;if(l(a))return!0}return!1}function k(a,b){return i(a,b)?!1:l(a)?!1:!0}function l(a){return s.inArray(a+1,A.visiblePages)>-1}function m(a,b){for(var c=s.sign(b-a);a!==b;)u.queuePageToLoad(a),a+=c;u.queuePageToLoad(a)}var n,o,p,q,r,s=a.getUtility("common"),t=a.getUtility("browser"),u={},v=[],w=1,x=!0,y=1,z=!1,A={page:1,visiblePages:[1]};return s.extend(u,{messages:["beforezoom","pageavailable","pagefocus","ready","scroll","scrollend","zoom"],onmessage:function(a,b){switch(a){case"beforezoom":this.handleBeforeZoom(b);break;case"pageavailable":this.handlePageAvailable(b);break;case"pagefocus":this.handlePageFocus(b);break;case"ready":this.handleReady();break;case"scroll":this.handleScroll();break;case"scrollend":this.handleScrollEnd();break;case"zoom":this.handleZoom(b)}},init:function(a){n=a,o=n.length,w=t.mobile||t.ielt10?pa:oa,w=Math.min(w,o)},destroy:function(){this.cancelAllLoading()},updateLayoutState:function(a){y=s.sign(a.page-A.page),A=a},loadNecessaryPages:s.debounce(100,function(){this.cancelAllLoading(),this.queuePageToLoad(A.page-1),this.loadVisiblePages(),this.loadPagesInRange(w)}),loadPagesInRange:function(a){var b=A.page-1;a>0&&(a=c(a),y>=0?(m(b+1,a.max),m(b-1,a.min)):(m(b-1,a.min),m(b+1,a.max)))},loadVisiblePages:function(){var a,b;for(a=0,b=A.visiblePages.length;b>a;++a)this.queuePageToLoad(A.visiblePages[a]-1)},queuePageToLoad:function(a){j(a)&&(n[a].preload(),g(a))},cancelAllLoading:function(){clearTimeout(q),clearTimeout(p),h()},loadPage:function(a,c){b.when(n[a]&&n[a].load()).always(c)},unloadPage:function(a){var b=n[a];b&&b.unload()},unloadUnnecessaryPages:function(a){var b,c;for(b=0,c=n.length;c>b;++b)k(b,a)&&this.unloadPage(b)},handleReady:function(){z=!0,this.loadVisiblePages(),q=setTimeout(function(){u.loadNecessaryPages()},qa)},handlePageAvailable:function(a){if(z){var b;if(a.all===!0&&(a.upto=o),a.page)this.queuePageToLoad(a.page-1);else if(a.upto)for(b=0;b<a.upto;++b)this.queuePageToLoad(b)}},handlePageFocus:function(a){this.updateLayoutState(a),z&&(this.cancelAllLoading(),p=setTimeout(function(){u.loadNecessaryPages()},200))},handleBeforeZoom:function(a){z&&(this.cancelAllLoading(),this.unloadUnnecessaryPages(2*a.visiblePages.length))},handleZoom:function(a){this.updateLayoutState(a),z&&this.loadNecessaryPages()},handleScroll:function(){this.cancelAllLoading()},handleScrollEnd:function(){z&&(this.loadNecessaryPages(),this.unloadUnnecessaryPages(w))}})}),Ca.addComponent("page-img",function(a){var c,d,e,f,g=a.getUtility("browser"),h=!1,i=g.mobile;return{init:function(a,c){d=b(a),f=c},destroy:function(){i=!0,this.unload(),d.empty()},prepare:function(){},preload:function(){e||(e=a.get("page-img",f))},load:function(){return this.preload(),e.done(function(a){h||(h=!0,c=b(a).appendTo(d))}),e.fail(function(b){h=!1,b&&a.broadcast("asseterror",b)}),e},unload:function(){e&&(e.abort(),e=null),i&&(c&&(c.remove(),c=null),h=!1)}}}),Ca.addComponent("page-links",function(a){function c(a){var c=b("<a>").addClass(A),g=a.bbox[0],h=a.bbox[1],i={};if(f.ie&&b("<span>").appendTo(c).on("click",d),c.css({left:g+"pt",top:h+"pt",width:a.bbox[2]-g+"pt",height:a.bbox[3]-h+"pt"}),a.uri){if(!/^http|^mailto/.test(a.uri))return;i.href=encodeURI(a.uri),i.target="_blank"}else a.destination&&(i.href="#page-"+a.destination.pagenum);c.attr(i),c.data("link",a),c.appendTo(e)}function d(c){var d=f.ie?c.target.parentNode:c.target,e=b(d),g=e.data("link");g&&a.broadcast("linkclick",g),c.preventDefault()}var e,f=a.getUtility("browser");return{init:function(a,c){e=b(a),this.createLinks(c),f.ie||e.on("click","."+A,d)},destroy:function(){e.empty().off("click"),e=f=null},createLinks:function(a){var b,d;for(b=0,d=a.length;d>b;++b)c(a[b])}}}),Ca.addComponent("page-svg",function(c){function d(){switch(v){case ua:case Aa:return b("<iframe>");case za:case va:return b("<object>").attr({type:ra,data:"data:"+ra+";base64,"+a.btoa(ta)});case wa:return b("<div>");case xa:return b("<object>");case ya:case Ba:return b("<img>")}}function e(){k&&0!==k.length||(s=!1,k=d()),0===k.parent().length&&k.appendTo(l)}function f(){return s||v===xa||v===ya?b.Deferred().resolve().promise({abort:function(){}}):c.get("page-svg",n)}function g(a){var b=a.querySelectorAll("use");[].forEach.call(b,function(b){var c=b.getAttribute("xlink:href"),d=a.querySelector(c).cloneNode(),e=b.parentNode;d.removeAttribute("id"),d.setAttribute("transform",b.getAttribute("transform")),e.replaceChild(d,b)})}function h(b){var d,e,f,h,i,j=k[0].contentDocument,l=k[0].contentWindow||j&&j.defaultView;switch(v){case ua:o.ielt10&&(b=b.replace(/<xhtml:link.*/,"")),h=sa+b,o.ielt10?j.body.innerHTML=h:(j.documentElement.innerHTML=h,(o.ios||o.safari)&&o.version<7&&g(j)),f=j.getElementsByTagName("svg")[0];break;case Aa:j.documentElement.innerHTML=sa;var m=j.getElementsByTagName("head")[0]||j.documentElement,q=j.createElement("script"),r="("+proxySVG+")()";q.type="text/javascript";try{q.appendChild(document.createTextNode(r))}catch(s){q.text=r}return m.insertBefore(q,m.firstChild),void("complete"===j.readyState?l.loadSVG(b):l.onload=function(){this.loadSVG(b)});case va:d=new p,e=d.parseFromString(b,ra),f=j.importNode(e.documentElement,!0),j.documentElement.appendChild(f);break;case za:l.loadSVG(b),f=j.querySelector("svg");break;case wa:d=new p,e=d.parseFromString(b,ra),f=document.importNode(e.documentElement,!0),k.append(f);break;case xa:k.attr({type:ra,data:c.getDataProvider("page-svg").getURL(n)}),f=k[0];break;case ya:f=k[0],f.src=c.getDataProvider("page-svg").getURL(n);break;case Ba:f=k[0],i="data:"+ra,f.src=!o.ie&&a.btoa?i+";base64,"+a.btoa(b):i+","+encodeURIComponent(b)}f.setAttribute("width","100%"),f.setAttribute("height","100%")}function i(a){q||r||(!s&&a&&(h(a),s=!0,u||(m.abort(),m=null)),0===k.parent().length&&k.appendTo(l))}function j(a){c.broadcast("asseterror",a),s=!1,m&&m.abort()}var k,l,m,n,o=c.getUtility("browser"),p=a.DOMParser,q=!1,r=!1,s=!1,t=c.getConfig(),u=o.mobile||o.ielt10,v=o.ielt11||o.firefox?Ba:ua;return{init:function(a,b){l=a,n=b,v=t.embedStrategy||v},destroy:function(){q=!0,u=!0,this.unload(),l.empty()},prepare:function(){e()},preload:function(){this.prepare(),m||(m=f())},load:function(){return r=!1,this.preload(),m.done(i).fail(j),m},unload:function(){r=!0,m&&"resolved"!==m.state()&&(m.abort(),m=null),u&&(k&&(k.remove(),k=null),s=!1)}}}),Ca.addComponent("page-text",function(a){function c(){return n.enableTextSelection&&!j.ielt9}function d(a){var b,c;!a||m||l||(m=!0,b=document.implementation.createHTMLDocument(""),b.getElementsByTagName("body")[0].innerHTML=a,a=null,c=document.importNode(b.querySelector("."+z),!0),g.attr("class",c.getAttribute("class")),g.html(c.innerHTML),k.fix(g))}function e(b){b&&a.broadcast("asseterror",b)}function f(){return h||(h=c()?a.get("page-text",i):b.Deferred().resolve().promise({abort:function(){}})),h}var g,h,i,j=a.getUtility("browser"),k=a.getUtility("subpx"),l=!1,m=!1,n=a.getConfig();return{init:function(a,b){g=a,i=b},destroy:function(){l=!0,this.unload(),g.empty()},preload:function(){f()},load:function(){return f().done(d).fail(e)},unload:function(){h&&"resolved"!==h.state()&&(h.abort(),h=null)},enable:function(){g.css("display",""),h&&!m&&(h=null)},disable:function(){g.css("display","none")}}}),Ca.addComponent("page",function(a){var c,d,e,f,g,h,i,j,k=a.getUtility("support"),l=a.getUtility("common"),m=!1;return{messages:["pageavailable","pagefocus","textenabledchange","zoom"],onmessage:function(a,b){switch(a){case"pageavailable":(b.page===h+1||b.upto>h||b.all===!0)&&j===ba&&(j=ca);break;case"textenabledchange":b.enabled===!0?this.enableTextSelection():this.disableTextSelection();break;case"pagefocus":case"zoom":i=g===b.page||l.inArray(g,b.visiblePages)>-1}},init:function(b,i){var l,m,n;c=b,m=b.find("."+y),l=b.find("."+z),n=b.find("."+B),j=i.status||ca,h=i.index,g=h+1,this.config=i,i.url=i.url||"",d=a.createComponent("page-text"),void 0===i.useSVG&&(i.useSVG=!0),e=a.createComponent(k.svg&&i.useSVG?"page-svg":"page-img"),d.init(l,g),e.init(m,g),i.enableLinks&&i.links.length&&(f=a.createComponent("page-links"),f.init(n,i.links))},destroy:function(){this.unload()},preload:function(){e.prepare(),j===ca&&(e.preload(),d.preload())},load:function(){var f=this;return m=!0,j===fa?!1:j===ba?!1:(j!==ea&&(j=da),b.when(e.load(),d.load()).done(function(){m?j!==ea&&(c.removeClass(D),j=ea,a.broadcast("pageload",{page:g})):f.unload()}).fail(function(b){j=fa,c.addClass(E),a.broadcast("pagefail",{page:h+1,error:b})}))},unload:function(){m=!1,e.unload(),d.unload(),j===ea&&(j=ca,c.addClass(D),c.removeClass(E),a.broadcast("pageunload",{page:g}))},enableTextSelection:function(){d.enable(),i&&d.load()},disableTextSelection:function(){d.disable()}}}),Ca.addComponent("resizer",function(c){function d(){c.broadcast("resize",{width:k,height:l,clientWidth:i,clientHeight:j,offsetWidth:k,offsetHeight:l})}function e(){var a=m.getComputedStyle(h);a&&"static"===a.position&&b(h).css({position:"relative"})}function f(){var a=b('<iframe frameborder="0">'),c=b("<div>");a.add(c).css({opacity:0,visiblility:"hidden",position:"absolute",width:"100%",height:"100%",top:0,left:0,border:0}),a.prependTo(c.prependTo(h)),e(),o=b(a[0].contentWindow),o.on("resize",g)}function g(){var b=h.offsetHeight,f=h.offsetWidth;return r&&0===q&&0!==a.innerWidth?(q=a.innerWidth,e(),void c.broadcast("layoutchange")):void(b&&(b!==l||f!==k)&&(l=b,k=f,j=h.clientHeight,i=h.clientWidth,d()))}var h,i,j,k,l,m=c.getUtility("common"),n=[""," webkit"," moz"," "].join("fullscreenchange")+"MSFullscreenChange",o=b(a),p=b(document),q=0,r=function(){try{return a.self!==a.top}catch(b){return!0}}();return{messages:["layoutchange"],onmessage:function(){l=null,g()},init:function(c){h=b(c).get(0),h===a?(h=document.documentElement,o.on("resize",g)):f(),p.on(n,g),g()},destroy:function(){p.off(n,g),o.off("resize",g)}}}),Ca.addComponent("scroller",function(a){function c(){return{scrollTop:j.scrollTop(),scrollLeft:j.scrollLeft()}}function d(){r=!1,w=null,clearTimeout(k),a.broadcast("scrollend",c())}function e(){r||(r=!0,a.broadcast("scrollstart",c())),clearTimeout(k),k=setTimeout(d,q),x()}function f(){s=!0,t=!1,u=!1,e()}function g(){u=!0,e()}function h(){s=!1,t=!0,v=(new Date).getTime(),u&&i()}function i(){return clearTimeout(k),null===w&&(w=(new Date).getTime()),(new Date).getTime()-w>n?void d():(x(),void(k=setTimeout(i,o)))}var j,k,l=a.getUtility("common"),m=a.getUtility("browser"),n=3e3,o=30,p=200,q=m.mobile?500:250,r=!1,s=!1,t=!1,u=!1,v=0,w=null,x=l.throttle(p,function(){a.broadcast("scroll",c())});return{init:function(a){j=b(a),j.on("scroll",e),j.on("touchstart",f),j.on("touchmove",g),j.on("touchend",h)},destroy:function(){clearTimeout(k),j.off("scroll",e),j.off("touchstart",f),j.off("touchmove",g),j.off("touchend",h)}}}),Ca.addComponent("viewer-base",function(c){function d(){w.attr(e,v.metadata.version||"0.0.0"),E.mobile&&w.addClass(o),E.ielt9&&w.addClass(p),F.svg&&v.useSVG&&w.addClass(q)}function i(){w.html(Ca.viewerTemplate),v.useWindowAsViewport?(v.$viewport=b(a),w.addClass(r)):v.$viewport=w.find("."+h),v.$doc=w.find("."+g)}function l(){var a,b,d=v.plugins||{};for(a in d)b=c.createComponent("plugin-"+a),b&&D.isFn(b.init)&&b.init(v.plugins[a])}function m(){d(),z=c.createComponent("scroller"),z.init(v.$viewport),A=c.createComponent("resizer"),A.init(v.$viewport);var a;switch(v.metadata.type){case"text":a=c.createComponent("controller-text"),v.layout=aa;break;case"paged":default:a=c.createComponent("controller-paged")}a.init(),"text"===v.metadata.type?v.enableTextSelection||u.disableTextSelection():E.ielt9&&u.disableTextSelection(),(!v.enableLinks||E.ielt9)&&u.disableLinks(),u.setLayout(v.layout),c.broadcast("ready",{page:v.page||1,numPages:v.numPages}),c.ready()}function n(b){var c=u.fire("linkclick",b);c.isDefaultPrevented()||(b.uri?a.open(b.uri):b.destination&&u.scrollTo(b.destination.pagenum))}function s(a){a?B||(w.addClass(j),B=c.createComponent("dragger"),B.init(v.$viewport)):B&&(w.removeClass(j),c.destroyComponent(B),B=null)}function t(){var a;v.queryParams&&(a="string"==typeof v.queryParams?v.queryParams.replace(/^\?/,""):D.param(v.queryParams)),v.queryString=a?"?"+a:""}var u,v,w,x,y,z,A,B,C,D=c.getUtility("common"),E=c.getUtility("browser"),F=c.getUtility("support");return{messages:["asseterror","destroy","dragend","dragstart","fail","layoutchange","linkclick","pagefail","pagefocus","pageload","pageunload","ready","resize","scrollstart","scrollend","zoom"],onmessage:function(a,b){switch(a){case"layoutchange":u.updateLayout();break;case"linkclick":n(b);break;case"zoom":b.zoom*=v.pageScale,b.prevZoom*=v.pageScale,v.enableDragging&&s(b.isDraggable),u.fire(a,b);break;case"dragstart":w.hasClass(k)||w.addClass(k),u.fire(a,b);break;case"dragend":w.hasClass(k)&&w.removeClass(k),u.fire(a,b);break;default:u.fire(a,b)}},init:function(){if(v=c.getConfig(),u=v.api,v.namespace=f+"-"+v.id,w=v.$el,w.addClass(f),w.addClass(v.namespace),!v.url)throw new Error("no URL given for viewer assets");/\/$/.test(v.url)||(v.url+="/"),v.url=c.getUtility("url").makeAbsolute(v.url),void 0===v.useSVG&&(v.useSVG=!0),t(),i(),l()},destroy:function(){w.empty().removeClass(function(a,b){var c=b.match(new RegExp("crocodoc\\S+","g"));return c&&c.join(" ")}),b(x).remove(),C&&C.abort()},setLayout:function(a){var b,d=v.page,e=v.zoom||1,f=v.layout;if(y){if(a===f)return y;d=y.state.currentPage,e=y.state.zoomState}if(b=c.createComponent("layout-"+a),!b)throw new Error("Invalid layout "+a);return y&&c.destroyComponent(y),v.layout=a,y=b,y.init(),y.setZoom(e.zoomMode||e.zoom||e),D.isFn(y.scrollTo)&&y.scrollTo(d),v.currentLayout=y,c.broadcast("layoutchange",{previousLayout:f,layout:a}),y},loadAssets:function(){var a,d,e,f;C||(d=c.get("metadata"),d.then(function(a){v.metadata=a}),E.ielt9?(x=D.insertCSS(""),v.stylesheet=x.styleSheet,a=b.when("").promise({abort:function(){}})):(a=c.get("stylesheet"),a.then(function(a){x=D.insertCSS(a),v.stylesheet=x.sheet})),!v.autoloadFirstPage||v.pageStart&&1!==v.pageStart||(F.svg&&v.useSVG?e=c.get("page-svg",1):v.conversionIsComplete&&(e=c.get("page-img",1)),v.enableTextSelection&&(f=c.get("page-text",1))),C=b.when(d,a).fail(function(a){C&&C.abort(),c.ready(),c.broadcast("asseterror",a),c.broadcast("fail",a)}).then(m).promise({abort:function(){C=null,d.abort(),a.abort(),e&&e.abort(),f&&f.abort()}}))}}}),Ca})}("undefined"!=typeof window?window:this);